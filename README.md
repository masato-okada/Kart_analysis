# カートエンジン解析アプリ (Next.js版)

このアプリケーションは、カートのGPSデータとRPMデータからエンジンのトルク・パワー曲線を推定するNext.jsアプリケーションです。元のDashアプリケーションをNext.jsで再実装し、Vercelにデプロイできるようにしました。

## 機能

- CSVファイル（Alfano/Mychronロガー形式）のアップロード
- 自動カラム検出（RPM、速度、時間）
- エンジントルク・パワー曲線の推定
- 空気抵抗係数（CdA）と転がり抵抗係数（Crr）の自動推定
- リアルタイム可視化（Plotly.js）
- 結果のCSVダウンロード
- レスポンシブデザイン

## 技術スタック

- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **グラフ**: Plotly.js
- **CSV解析**: PapaParse
- **アイコン**: Lucide React
- **デプロイ**: Vercel

## セットアップ

### 1. 依存関係のインストール

```bash
npm install
# または
yarn install
```

### 2. 開発サーバーの起動

```bash
npm run dev
# または
yarn dev
```

### 3. ブラウザでアクセス

アプリケーションが起動したら、ブラウザで以下のURLにアクセスしてください：

```
http://localhost:3000
```

## デプロイ

### Vercelへのデプロイ

1. GitHubリポジトリにコードをプッシュ
2. [Vercel](https://vercel.com)にアクセス
3. 新しいプロジェクトを作成
4. GitHubリポジトリを選択
5. デプロイ設定を確認してデプロイ

### 手動デプロイ

```bash
npm run build
npm run start
```

## 使用方法

1. **CSVファイルのアップロード**: ドラッグ&ドロップまたはファイル選択でCSVファイルをアップロード
2. **パラメータ設定**: 車両質量、温度、気圧、効率などのパラメータを設定
3. **データ選択**: セッションやラップを選択し、表示モードを設定
4. **計算実行**: "解析実行"ボタンをクリックしてトルク・パワー曲線を計算
5. **結果確認**: グラフで結果を確認し、必要に応じてCSVファイルをダウンロード

## 対応ファイル形式

- Alfanoロガー形式
- Mychronロガー形式
- 一般的なCSV形式（RPM、速度、時間のカラムを含む）

## パラメータ説明

- **質量**: ドライバー+カート+燃料の総質量（kg）
- **温度**: 環境温度（°C）
- **気圧**: 環境気圧（hPa）
- **効率**: ドライブトレイン効率（0.85-0.95）
- **CdA**: 空気抵抗係数（m²）
- **Crr**: 転がり抵抗係数
- **RPMビン幅**: データ集約のためのRPM範囲
- **パーセンタイル**: 外れ値除去のためのパーセンタイル
- **最大スリップ率**: データ品質フィルタリング用

## 注意事項

- データは加速時のみ使用されます
- スリップ率が大きいデータは除外されます
- 最低速度以下のデータは除外されます
- 空気密度は温度と気圧から自動計算されます
- ブラウザでのみ動作し、サーバーサイドでのデータ処理は行いません

## 元のDashアプリとの違い

- **フロントエンド**: Dash → Next.js + React
- **データ処理**: Python → TypeScript/JavaScript
- **グラフ**: Plotly (Python) → Plotly.js
- **デプロイ**: ローカルサーバー → Vercel
- **UI**: Dash HTML → Tailwind CSS + カスタムコンポーネント

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。
